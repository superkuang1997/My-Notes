# äºŒåˆ†æŸ¥æ‰¾

## å¯»æ‰¾æŸä¸ªå€¼

### i<=j
ğŸ‘‰ æ€è·¯ï¼š

å¦‚æœå¾ªç¯æ¡ä»¶ä½¿ç”¨ `while(i <= j)` ï¼Œæ­¤æ—¶å¾ªç¯çš„ç»ˆæ­¢æ¡ä»¶ä¸º `i == j + 1` ï¼Œæ­¤æ—¶åŒºé—´ä¸º `[j + 1, j]`ï¼Œä»£å…¥ä¸€ä¸ªå…·ä½“çš„æ•°å­—è¿›å» `[3, 2]`ï¼Œæ­¤æ—¶æ‰€æœ‰çš„æ•°å­—éƒ½è¢«æœç´¢å®Œäº†ï¼Œå› ä¸ºæ²¡æœ‰ä»»ä½•ä¸€ä¸ªæ•°å­—æ—¢å¤§äºç­‰äº 3 åˆå°äºç­‰äº 2 

æœ€åä¸€æ¬¡å¾ªç¯åœ¨ i == j æ—¶ï¼š

- æ­¤æ—¶ `mid = 2j/2 = j`ï¼Œè¯´æ˜ j å¯ä»¥è¢«å–åˆ°ï¼ŒåŒæ—¶ä¸ºäº†é¿å… `nums[mid]` ç´¢å¼•è¶Šç•Œï¼Œj åˆå§‹åŒ–æ—¶çš„åˆå€¼ä¸º `nums.length - 1` 

  > æ˜¯åˆå§‹åŒ– `j = nums.length - 1` çš„åŸå› 

- æ­¤æ—¶ `mid = 2i/2 = i` ï¼Œè¯´æ˜ i ä¹Ÿå¯ä»¥è¢«å–åˆ°

ç»¼åˆä»¥ä¸Šä¸¤ç‚¹ï¼Œè¯´æ˜å¾ªç¯ä¸­ i åˆ° j çš„ä»»æ„ä¸€ä¸ªæ•°éƒ½å¯èƒ½è¢«å–åˆ°ï¼Œ `while(i <= j)` çš„æœç´¢åŒºé—´ä¸º  `[i, j]`


```java
public int search(int[] nums, int target) {
    int i = 0, j = nums.length - 1, mid = 0;
    while (i <= j) {
        mid = i + ((j - i) >> 1);
        if (nums[mid] == target) {
            return mid;
        }
        if (nums[mid] < target) {
            i = mid + 1;
        } 
        else {
            j = mid - 1;
        }
    }
    return -1;
}
```


### i < j

ğŸ‘‰è¾¹ç•Œæ¡ä»¶ï¼š

æ‰¾åˆ°å…·ä½“å€¼æ‰è¿”å›ï¼Œæ²¡æ‰¾åˆ°ç›´æ¥è¿”å› -1


ğŸ‘‰ æ€è·¯ï¼š

å¦‚æœå¾ªç¯æ¡ä»¶ä½¿ç”¨ `while(i < j)` ï¼Œæ­¤æ—¶å¾ªç¯çš„ç»ˆæ­¢æ¡ä»¶ä¸º `i == j ` 

æœ€åä¸€æ¬¡å¾ªç¯åœ¨ `i = j - 1` æ—¶ï¼š

- æ­¤æ—¶  `mid = (2j - 1) / 2 = j - 1 ` ï¼Œè¯´æ˜ mid æ— æ³•å–åˆ° j çš„ï¼Œäºæ˜¯ j åˆå§‹åŒ–æ—¶çš„åˆå€¼è®¾ä¸º `nums.length` ï¼Œè¿™æ ·`nums[mid]` ç´¢å¼•å°±ä¸ä¼šè¶Šç•Œ

  > æ˜¯åˆå§‹åŒ– `j = nums.length` çš„åŸå› 

- æ­¤æ—¶ `mid = (2i + 1) / 2 = i` ï¼Œè¯´æ˜ i å¯ä»¥è¢«å–åˆ°

ç»¼åˆä»¥ä¸Šä¸¤ç‚¹ï¼Œ `while(i < j)` çš„æœç´¢åŒºé—´ä¸º  `[i, j)`



ğŸ‘‰è¾¹ç•Œæ¡ä»¶ï¼š

å¾ªç¯çš„ç»ˆæ­¢æ¡ä»¶ä¸º `i == j`  ï¼Œæ­¤æ—¶æœç´¢åŒºé—´ä¸º `[j, j)` ï¼Œj æ˜¯å–ä¸åˆ°çš„ï¼Œæ‰€ä»¥ä»æœ‰ä¸€ä¸ªæ•°å­— j æ²¡æœ‰è¢«æœç´¢åˆ°ï¼Œä½† while å¾ªç¯å·²ç»åœæ­¢ï¼Œæ‰€ä»¥æ­¤æ—¶éœ€è¦å¤šåŠ ä¸€ä¸ªåˆ¤æ–­ã€‚

åˆ¤æ–­æ²¡è¢«æœç´¢çš„æ•°å­— j æ˜¯å¦æ˜¯ targetï¼Œä¸æ˜¯å°±è¿”å› -1 


```java
public int search(int[] nums, int target) {
    int i = 0, j = nums.length, mid = 0;
    while (i < j) {
        mid = i + ((j - i) >> 1);
        if (nums[mid] == target) {
            return mid;
        }
        if (nums[mid] < target) {
            i = mid + 1;
        } 
        else {
            j = mid - 1;
        }
    }
    return nums[i] == target ? i : -1;
}
```





## å¯»æ‰¾æŸä¸ªå€¼çš„å³ä¾§è¾¹ç•Œ

### i<j

ğŸ‘‰ æ€è·¯ï¼š

åŒç†ï¼Œç”±äºæ˜¯å¯»æ‰¾å³ä¾§è¾¹ç•Œï¼Œæ‰€ä»¥ `target == nums[mid]` æ—¶ç¼©å°å·¦ä¾§è¾¹ç•Œ



ğŸ‘‰ è¾¹ç•Œæƒ…å†µï¼š

å¯¹äº target ä¸å­˜åœ¨äº nums[i] çš„åˆ¤æ–­ï¼Œå¾ªç¯ç»“æŸå‰çš„æœ€åæœç´¢åŒºé—´ä¸º `[i, j) = [j-1, j)`ï¼Œåªèƒ½å–åˆ° j - 1

- å½“ target ä¸å­˜åœ¨äº nums[i] ä¸”è¾ƒå°æ—¶ï¼Œèµ° `j = mid`ï¼Œæœ‰ `[j-1, j) -> [j-1, j-1)`ï¼Œå·¦è¾¹ç•Œ i ä¸€ç›´ä¸º 0ï¼Œæ•… `[j-1, j-1) = [0,0)`

- å½“ target ä¸å­˜åœ¨äº nums[i] ä¸”è¾ƒå¤§æ—¶ï¼Œèµ° `i = mid + 1 `ï¼Œ` [j-1, j) -> [j-1+1,j) = [j,j)  `ï¼Œå³è¾¹ç•Œ j ä¸€ç›´ä¸º nums.length

```java
int right_bound(int[] nums, int target) {
    if (nums.length == 0) return -1;
    int i = 0, j = nums.length;

    while (i < j) {
        int mid = (i + j) / 2;
        if (target == nums[mid]) {
            i = mid + 1; // æ³¨æ„
        }
        else if (target > nums[mid]) {
            i = mid + 1;
        }
        else if (target < nums[mid]) {
            j = mid;
        }
    }
    // targetå°äºnumsä¸­ä»»ä½•ä¸€ä¸ªå€¼
    if (i == 0 || nums[i - 1] != target) {
        return -1;
    }
    // targetå¤§äºnumsä¸­ä»»ä½•ä¸€ä¸ªå€¼
    return i - 1;
}
```



### i<=j

ğŸ‘‰ æ€è·¯ï¼š

åŒç†



ğŸ‘‰ è¾¹ç•Œæƒ…å†µï¼š

å¯¹äº target ä¸å­˜åœ¨äº nums[i] çš„åˆ¤æ–­ï¼Œæœ€åä¸€æ¬¡å¾ªç¯çš„æœç´¢åŒºé—´ä¸º `[i, j] = [j, j]`ï¼Œåªèƒ½å–åˆ° jï¼ˆæˆ–è€…iï¼‰

- å½“ target ä¸å­˜åœ¨äº nums[i] ä¸”è¾ƒå°æ—¶ï¼Œæœ‰ j = j - 1ï¼Œåˆ™ `[j, j-1]`ï¼Œè€Œå·¦è¾¹ç•Œæœ€å°æ˜¯ 0ï¼Œæ‰€ä»¥ j ä¸º -1

- å½“ target ä¸å­˜åœ¨äº nums[i] ä¸”è¾ƒå¤§æ—¶ï¼Œæœ‰ i = j + 1 ï¼Œåˆ™`[j+1,j]` ï¼Œå³è¾¹ç•Œä¸€ç›´æ˜¯ nums.length - 1ï¼Œæ‰€ä»¥ j = nums.length - 1

```java
int right_bound(int[] nums, int target) {
    if (nums.length == 0) return -1;
    int i = 0, j = nums.length - 1;

    while (i <= j) {
        int mid = (i + j) / 2;
        if (target == nums[mid]) {
            i = mid + 1;
        }
        else if (target > nums[mid]) {
            i = mid + 1;
        }
        else if (target < nums[mid]) {
            j = mid - 1;
        }
    }
    // targetå°äºã€å¤§äºnumsä¸­ä»»ä½•ä¸€ä¸ªå€¼çš„æƒ…å†µ
    if (j < 0 || nums[j] != target) {
        return -1;
    }
    return j;
}
```





## å¯»æ‰¾æŸä¸ªå€¼çš„å·¦ä¾§è¾¹ç•Œ

### i<j

ğŸ‘‰ æ€è·¯ï¼š

å¦‚æœä½¿ç”¨äº† `while(i < j)`ï¼Œé…å¥—ä½¿ç”¨ `j = nums.length`ï¼Œæœç´¢ç©ºé—´ä¸º `[i, j)` ï¼Œåœ¨ mid è¢«æœç´¢è¿‡ä¹‹åï¼ŒåŒºé—´åº”è¯¥è¢«åˆ†æˆ `[i, mid)` å’Œ `[mid + 1, j)`

æ‰€ä»¥ `target < nums[mid]` æ—¶ï¼Œç¼©å°å³ä¾§åŒºé—´ï¼Œä½¿ `j = mid`ï¼Œ`target > nums[mid]` æ—¶ï¼Œç¼©å°å·¦ä¾§åŒºé—´ï¼Œä½¿ `i = mid + 1`

ä¹‹æ‰€ä»¥èƒ½å¤Ÿæœç´¢å·¦ä¾§åŒºé—´ï¼Œå…³é”®åœ¨äºå¯¹ `target == nums[mid]` è¿™ç§æƒ…å†µçš„å¤„ç†ï¼Œå› ä¸ºè¦å–å·¦ä¾§è¾¹ç•Œï¼Œæ‰€ä»¥è¦ç¼©å°å³ä¾§åŒºé—´ï¼Œå› æ­¤å– `j = mid` ï¼Œåœ¨åŒºé—´ `[i, midï¼‰` ä¸­ç»§ç»­æœç´¢



ğŸ‘‰ è¾¹ç•Œæƒ…å†µï¼š

æœ€åä¸€æ¬¡å¾ªç¯æ—¶ï¼Œi = j - 1

- target å°çš„æƒ…å†µä¸‹ï¼Œæ›´æ–° `j = mid = (2j - 1)/ 2 = j - 1`ï¼Œi ä¸€ç›´æ˜¯ 0

  > 2j - 1 æ˜¯ä¸€ä¸ªå¥‡æ•°ï¼Œç„¶åå†å‘ä¸‹æ•´é™¤å°±å¾—åˆ° j - 1

- target å¤§çš„æƒ…å†µä¸‹ï¼Œæ›´æ–° `i = mid + 1 = (2j - 1) / 2 + 1 = j`ï¼Œj  ä¸€ç›´æ˜¯ nums.length - 1ï¼Œç›´æ¥ç´¢å¼•å³å¯

```java
int left_bound(int[] nums, int target) {
    if (nums.length == 0) return -1;
    int i = 0;
    int j = nums.length;
    
    while (i < j) { 
        int mid = i + (j - i) / 2;
        if (target == nums[mid]) {
            j = mid;
        } 
        else if (target > nums[mid] ) {
            i = mid + 1;
        } 
        else if (target < nums[mid]) {
            j = mid; 
        }
    }
    // æ£€æŸ¥targetå¤§äºnumsä¸­ä»»ä½•ä¸€ä¸ªæ•°ä»¥åŠå°äºçš„æƒ…å†µ
    if (i >= nums.length || nums[i] != target) {
        return -1;
    }    
    return i;
}
```



### i<=j

ğŸ‘‰ æ€è·¯ï¼š

å¦‚æœä½¿ç”¨äº† `while(i <= j)`ï¼Œé…å¥—ä½¿ç”¨ `j = nums.length - 1` ï¼Œæœç´¢ç©ºé—´ä¸º `[i, j]` ï¼Œåœ¨ mid è¢«æœç´¢è¿‡ä¹‹åï¼ŒåŒºé—´åº”è¯¥è¢«åˆ†æˆ `[i, mid - 1]` å’Œ `[mid + 1, j]` ï¼ŒåŒºé—´ç¼©å°çš„æ€è·¯åŒç†ã€‚



ğŸ‘‰ è¾¹ç•Œæƒ…å†µï¼š

æœ€åä¸€æ¬¡å¾ªç¯æ—¶ï¼Œi = j

- target å°çš„æƒ…å†µä¸‹ï¼Œæ›´æ–° j = mid - 1 = i - 1ï¼Œi ä¸€ç›´æ˜¯ 0

- target å¤§çš„æƒ…å†µä¸‹ï¼Œæ›´æ–° i = mid + 1 = j + 1ï¼Œj  ä¸€ç›´æ˜¯nums.length - 1ï¼Œæ•… i ä¸º nums.lengthï¼Œç´¢å¼•æ—¶æ³¨æ„ä¸è¦è¶Šç•Œ

```java
int left_bound(int[] nums, int target) {
    int i = 0;
    int j = nums.length - 1;
    
    while (i <= j) { 
        int mid = i + (j - i) / 2;
        if (target == nums[mid]) {
            j = mid - 1;
        } 
        else if (target > nums[mid] ) {
            i = mid + 1;
        } 
        else if (target < nums[mid]) {
            j = mid - 1; 
        }
    }
    // æ£€æŸ¥targetå¤§äºnumsä¸­ä»»ä½•ä¸€ä¸ªæ•°ä»¥åŠå°äºçš„æƒ…å†µ
    if (i >= nums.length || nums[i] != target) {
        return -1;
    }
    return i;    
}
```







## é˜²æ­¢æº¢å‡º

ä»£ç ä¸­ `i + (j - i) / 2` å’Œ `(i + j) / 2` çš„ç»“æœç›¸åŒï¼Œä½†å¯ä»¥æœ‰æ•ˆé˜²æ­¢äº† `i` å’Œ `j` å¤ªå¤§ç›´æ¥ç›¸åŠ å¯¼è‡´æº¢å‡ºã€‚

`i + (j - i) / 2` ä¹Ÿå¯ä»¥å†™æˆ `i + ((j - i) >> 1)`



## å‘ä¸Š/å‘ä¸‹å–æ•´

å–ä¸­å€¼ mid æ—¶ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š

- å‘ä¸‹å–æ•´ï¼š`mid = i + ((j - i) >> 1`

- å‘ä¸Šå–æ•´ï¼š`mid = i + ((j - i + 1) >> 1`

å¯¹äº  `while(i <= j)`  ï¼Œä¸¤ç§å–æ•´æ–¹å¼çš„ç»“æœæ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œå› ä¸ºæœç´¢ç©ºé—´æ˜¯ `[i, j]` ï¼Œæ¯ä¸€ä¸ªæ•°éƒ½è¢«æœç´¢åˆ°äº†ã€‚

å¯¹äº `while(i < j)` ï¼Œæœ‰ä¸€ç‚¹åŒºåˆ«ï¼š

- ä¸€èˆ¬éƒ½æ˜¯æŠŠ `while(i < j)` çš„åŒºé—´è§†ä¸º`[i, j)` ï¼Œæ­¤äº‹åº”è¯¥ä½¿ç”¨å‘ä¸‹å–æ•´ï¼Œå¦‚æœå‘ä¸Šå–æ•´åˆ™ä¼šæ­»å¾ªç¯

  åŒºé—´å˜åŒ–ä¸º i = mid + 1 å’Œ j = mid ï¼Œå¦‚æœ i = 0, j = 1ï¼Œå‘ä¸Šå–æ•´æ—¶ m = 1ï¼Œå¦‚æœèµ° j = mid åˆ†æ”¯ï¼Œé‚£ä¹ˆ j ä»ç„¶ä¸º 1ï¼Œç›´æ¥æ­»å¾ªç¯ 

- åŒºé—´ä¹Ÿå¯ä»¥è§†ä¸º `(i, j]`ï¼ŒåŒç†ï¼Œè¿™æ—¶å°±å¿…é¡»å‘ä¸‹å–æ•´ï¼Œå¦‚æœå‘ä¸Šå–æ•´åˆ™ä¼šæ­»å¾ªç¯